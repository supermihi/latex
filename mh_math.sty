%% mh_math -- some useful general math definitions.
%% Copyright 2013 by Michael Helmling
%% Newest version: github.com/supermihi/latex
%% Feel free to use and modify to your wish!
% !TeX encoding = UTF-8
\NeedsTeXFormat{LaTeX2e}[2011/06/27]
\RequirePackage{expl3,l3keys2e,l3keys}
\ProvidesExplPackage
  {mh_math}
  {2013/10/10}
  {2}
  {Defines macros and loads package useful for mathematical typesetting}


\keys_define:nn { mhmath } {
  unimath      .bool_set:N  = \l_mhmath_unimath,
  unimath      .initial:n   = false,
  
  fonts        .bool_set:N  = \l_mhmath_myfonts,
  fonts        .initial:n   = false,
}

\ProcessKeysOptions { mhmath }
\relax


\RequirePackage{amsfonts,amsmath,amssymb}
\bool_if:nTF
  { !(\pdftex_if_engine_p:) && \l_mhmath_unimath }
  { \RequirePackage{unicode-math} }
  {  }


\bool_if:nTF
 {\l_mhmath_myfonts && (\pdftex_if_engine_p: || !(\l_mhmath_unimath)) }
 { \RequirePackage{euler} }
 {  }

\bool_if:nTF
  {\l_mhmath_myfonts && \l_mhmath_unimath && !(\pdftex_if_engine_p:) }
  {
    \unimathsetup{math-style=upright}
    \setmathfont{Neo~Euler}
    \setmathfont[range={\mathcal,\mathbfcal,\mathbb},StylisticSet=1]{XITS~Math}
  }
  {  }

\RequirePackage{mathtools}
\RequirePackage{xspace}

% Useful math abbreviations
\newcommand{\Z}{\mathbb{Z}} % integrals
\newcommand{\Q}{\mathbb{Q}} % fractions
\newcommand{\N}{\mathbb{N}} % integers
\newcommand{\R}{\mathbb{R}} % reals
\DeclareDocumentCommand\C{}{\mathbb{C}} % complex numbers
\newcommand{\F}{\mathbb{F}} % finite fields
\DeclareDocumentCommand\O{}{\mathcal{O}} % Landau notation
\newcommand{\E}{\mathbb{E}} % Expectation
\newcommand{\NP}{{\sffamily NP}} % NP complexity class
\DeclareDocumentCommand\P{}{\textsf{P}} % P complexity class
\newcommand{\Llra}{\ensuremath{\Longleftrightarrow}}

% Commands with size-adjusting braces
\newcommand{\abs}[1]{\left\lvert #1 \right\rvert} % absolute value
\newcommand{\norm}[1]{\left\| #1 \right\|} % norms
\newcommand{\legendre}[2]{\left(\frac{#1}{#2}\right)} % Legendre symbol (fraction in parentheses)
\newcommand{\gauss}[1]{\left\lfloor #1 \right\rfloor} % Gauss operator (floor)

% Text mode punctuation in display formulas
\newcommand\tp{\text{.}}
\newcommand\tk{\text{,}}
\newcommand\ts{\text{;}}

% := with vertically centered colon (requires mathtools)
\newcommand\definedAs{\vcentcolon=} 

\newcommand{\algname}[1]{\textsc{#1}} % name of algorithms in small caps

% Math operators
\newcommand{\op}[1]{\operatorname{#1}} % handy abbreviation
\DeclareMathOperator{\ggT}{ggT}
\DeclareMathOperator{\kgV}{kgV}
\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator{\conv}{conv}
\DeclareMathOperator{\aff}{aff}
\DeclareMathOperator{\eq}{eq}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\spn}{span}
